<html layout:decorate="~{/common/layout}" lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<head>
    <style>
      body{
        color : white !important;
      }
      article{
        margin-top: 5%;
      }
      h1{
        color:white;
      }
      article>figure{
        text-align: center;
      }
      .col-lg-12{
        background-image: url("/img/blog/back.jpg");
      }

    </style>
  <script  src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script type="text/javascript" th:src="@{/js/blog/comment.js}"></script>
</head>
<body>

<main id="main" data-aos="fade" data-aos-delay="1500">

  <!-- ======= End Page Header ======= -->
  <div class="page-header d-flex align-items-center">
    <div class="container position-relative">
      <div class="row d-flex justify-content-center">
        <div class="col-lg-10 text-center">
          <h2>Instruments And Music</h2>
        </div>
      </div>
    </div>
  </div>
  <!-- End Page Header -->

  <!-- Page Content Start -->

  <div layout:fragment="content" class="container mt-5">
    <div class="row">
      <div class="col-lg-12">
        <!-- Post content-->
        <article>
          <!-- Post header-->
          <header class="mb-4">
            <!-- Post title-->
            <h1 class="fw-bolder mb-1" th:text="${blog.blogTitle}"></h1>
            <!-- Post meta content-->
            <div class="text-muted fst-italic mb-2"th:text="${#temporals.format(blog.createDate, 'yyyy-MM-dd HH:mm')}"></div>
            <!-- Post categories-->
            <a class="badge bg-secondary text-decoration-none link-light" href="/product/list">Instruments</a>
          </header>
          
          <!-- Preview image figure-->
          <figure class="mb-4"><img class="img-fluid rounded"
                                    th:src="@{${blog.getFilePath()}}" onerror="this.src='/img/blog/default.jpg'" alt="..." /></figure>

          <!-- Post content-->
          <section class="mb-5">
            <p class="fs-5 mb-4" th:text="${blog.blogContent}"></p>
          </section>
        </article>

        <!-- 질문 수정 -->
        <div class="my-3">
          <a th:href="@{|/blog/modify/${blog.blogNo}|}" class="btn btn-sm btn-outline-secondary" th:text="수정"></a>

          <!-- 질문 삭제-->
          <a href="javascript:void(0);" th:data-uri="@{|/blog/delete/${blog.blogNo}|}"
             class="delete btn btn-sm btn-outline-secondary" th:text="삭제"></a>
        </div>
    </div>

      <!-- 작성란&버튼 -->
      <div class="col justify-content-center my-1 mx-0">
        <form method="POST" th:onclick="|updateComment()|" id="commentForm">
          <!-- hidden 영역 -->
          <input type="hidden" name="USER_ID" th:value="${comm.commWriter}">
          <input type="hidden" name="BLOG_NO" th:value="${comm.blogNo}">

          <!-- 입력 영역 -->
          <input type="text" id="content" name="CONTENT">
          <input type="button" th:onclick="|updateComment()|" value="댓글작성">
        </form>
      </div>

      <!-- 댓글 목록 -->
      <div id="commentTable">
        <div th:each="comment:${commentList}">
          <form method="POST">
            <input type="hidden" id="commNo" name="commNo" th:value="${comm.commNo}">
            <div>
              <input type="button" class="btn p-0 btn-md" name="commWriter" th:value="${comm.commWriter}" />
              <small th:text="${#strings.substring(comm.commDate,0,19)}"></small>
            </div>
            <div th:text="${comm.commContent}"></div>
            <div class="text-right" th:if="${comm.commWriter==userInform.commWriter}">
              <span><button type="submit" name="submit" value="update">수정</button></span>
              <span><button type="submit" name="submit" value="delete">삭제</button></span>
            </div>
          </form>
        </div>
      </div>

    </div>
  </div>
</main>
<!-- End #main -->



  <!-- 게시글 삭제 스크립트 -->
<script layout:fragment="script" type='text/javascript'>
    const delete_elements = document.getElementsByClassName("delete");
    Array.from(delete_elements).forEach(function(element) {
        element.addEventListener('click', function() {
            if(confirm("정말로 삭제하시겠습니까?")) {
                location.href = this.dataset.uri;
            };
        });
    });
</script>
</body>
</html>

