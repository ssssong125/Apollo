<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf?.token}">
    <meta name="_csrf_header" th:content="${_csrf?.headerName}">
    <script  src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <title>Title</title>
    <style>
        html{
            background-color: black;
        }
        /*tr{*/
        /*    color: white;*/
        /*}*/
        /*.prodList{*/
        /*    grid-template: repeat(3, 1fr);*/
        /*}*/
        .image{
            width: 200px;
            height: 300px;

        }

        .record{
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            column-gap: 50px;
            row-gap: 20px;
            padding: 5rem 16rem
        }
        .col{
            /*margin: 30px;*/
            width: 300px;
            padding: 10px 10px 20px 10px;
            border: 1px solid #bfbfbf;
            background-color: #fff;
            box-shadow: 2px 2px 3px rgba(135, 139,144,0.4);
            /* transform: rotate(9deg); */
            align-content: center;
        }

        .text-area p{
            margin-bottom: 0;
        }

        /*img{*/
        /*    width: 300px;*/
        /*    height: 180px;*/
        /*}*/

        p{
            text-align: center;
            /*font-family: "바탕";*/
            font-weight: 600;
            font-size: 16px;
            color: cadetblue;
        }
        #page-wrapper {
            padding-left: 250px;
        }

        #sidebar-wrapper {
            position: fixed;
            width: 250px;
            height: 100%;
            margin-left: -250px;
            background: #000;
            overflow-x: hidden;
            overflow-y: auto;
        }

        #page-content-wrapper {
            width: 100%;
            padding: 20px;
        }
        /* 사이드바 스타일 */

        .sidebar-nav {
            width: 250px;
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .sidebar-nav li {
            text-indent: 1.5em;
            line-height: 2.8em;
        }

        .sidebar-nav li a {
            display: block;
            text-decoration: none;
            color: #999;
            font-family: BodoniXT;

        }

        .sidebar-nav li a:hover {
            color: #ffd700;
            background: rgba(255, 255, 255, 0.2);
            font-size: 28px;

        }

        .sidebar-nav > .sidebar-brand {
            font-size: 1.3em;
            line-height: 3em;
        }
    </style>

</head>
<body>
<header>
    <div th:include="fragments/header.html"></div>

</header>
<br>
<br>

<<table class="layout">
    <colgroup>
        <col width="50%">
        <col width="50%">
    </colgroup>
    <tr>
        <td>
            <div style="margin-bottom: 30px;">
                <select name="classCode" onchange="changeClass();">
<!--                    (onchange(); 변화 JS 작성)-->
<!--                    <option selected value="C1">바이올린</option>-->
                    <option th:each="cate:${category}"
                            th:text="${cate.categoryName}"
                            th:value="${cate.categoryCode}"></option>
                </select>
            </div>
            <div>

                <table class="stu">
                    <thead>
                    <tr>
                        <td>학번</td>
                        <td>이름</td>
                        <td>나이</td>
                        <td>학급명</td>
                        <td></td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="product : ${ productList }">
                        <td><a th:href="@{|/product/detail/${product.productNo}|}">
                            <img th:src="@{${product.productImageDTOList.get(0).getImgPath()}}" class="image"/>
                        </a></td>
                        <td th:text="${ product.productName }"></td>
                        <td th:text="${ product.productPrice }"></td>
                        <td th:text="${ product.productPrice }"></td>
                        <td><input type="button" value="삭제"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </td>
        <td id="detailTd"></td>
    </tr>
</table>


<script src="https://code.jquery.com/
    jquery-latest.min.js"></script>
<!--<★jquery 실행>-->
<!--<script type="text/javascript" th:src="@{/stu_manage.js}"></script>-->
<!--★static폴더 기준-->
<!--</div>-->
<!--<div class="record">-->
<!--    <a th:href="@{/product/list/}">-->
<!--        <a href="product/" th:attrappend="href=${ productList.get(i).categoryCode }">-->
<!--        <img src="/img/common/present_3.jpg">-->
<!--    </a>-->

<!--    <button type="button" onclick="categoooo('STRING')">현악기</button>-->
<!--    <button type="button" onclick="categoooo('WIND')">관악기</button>-->
<!--    <button type="button" onclick="categoooo('CLAVIER')">건반악기</button>-->

<!--    <div class="col" th:each="product : ${ productList }">-->

<!--&lt;!&ndash;        <th:block th:if="bigCode =='WIND'">&ndash;&gt;-->
<!--            <div class="img-area">-->
<!--                <a th:href="@{|/product/detail/${product.productNo}|}">-->
<!--                    <img th:src="@{${product.productImageDTOList.get(0).getImgPath()}}" class="image"/>-->
<!--                </a>-->
<!--            </div>-->
<!--            &lt;!&ndash;<br>&ndash;&gt;-->
<!--            &lt;!&ndash;            <span th:text="${ product.productNo }"></span>&ndash;&gt;-->
<!--            <div class="text-area">-->
<!--                <p th:text="${ product.productName }"></p>-->
<!--                <p th:text="${ product.productPrice }"></p>-->
<!--                <a href="/cart/trolley">-->
<!--                    <p th:include="fragments/button.html"></p>-->
<!--                </a>-->
<!--            </div>-->
<!--&lt;!&ndash;        </th:block>&ndash;&gt;-->

<!--&lt;!&ndash;            <span th:text="${ product.productDesc }"></span>&ndash;&gt;-->

<!--        <div class="img-area">-->
<!--          <a th:href="@{|/product/detail/${product.productNo}|}">-->
<!--               <img th:src="@{${product.productImageDTOList.get(0).getImgPath()}}" class="image"/>-->
<!--          </a>-->
<!--        </div>-->
<!--    </div>-->
<!--&lt;!&ndash;<br>&ndash;&gt;-->
<!--&lt;!&ndash;            <span th:text="${ product.productNo }"></span>&ndash;&gt;-->
<!--        <div class="text-area">-->
<!--            <p th:text="${ product.productName }"></p>-->
<!--            <p th:text="${ product.productPrice }"></p>-->
<!--            <button type="button" class="btn btn-warning" th:onclick="|addToCart(${product.productNo}, 1)|" data-toggle="modal" data-target="#cartModal">Add To Cart</button>-->

<!--    </div>-->
<!--</div>-->
<!--<div class="prodList">-->
<!--    <div class="prod" th:each="product : ${ productList }">-->
<!--        <div th:src="@{/img/}"></div>-->
<!--        <div th:text="${product.productName}"></div>-->
<!--        <div th:text="${product.productPrice}"></div>-->
<!--        <div th:include="fragments/button.html"></div>-->
<!--        <div th:src="@{${item.getImgPath()}}"></div>-->
<!--    </div>-->
<!--</div>-->
<!--<button onclick="location.href='/product/regist'">상품등록</button>-->
<!--<button onclick="location.href='/product/edit'">상품정보수정</button>-->
<!--<button onclick="location.href='/product/delete'">상품삭제</button>-->
<!--<div th:src="@{${item.getImgPath()}}"></div>-->
<!--<footer>-->
    <div th:include="fragments/footer.html"></div>

<script th:inline="javascript">
    console.log(category.categoryCode)
    function changeClass() {
        const categoryCode = document.querySelector('select').value
        $.ajax({
            url: '/product/AjaxList',

            type: 'post',
            data: {'categoryCode': categoryCode},

            <!--    3)쿼리작업 끝난 후-->
            success: function (result) {
                <!--    ★return 값 받음-->
                <!--    controller 실행 후 자동실행 할 구문-->

// i) 테이블을 다시 그려준다(테이블의 thead, tbody 만들기)
                const ajaxList = document.querySelector('.stu');
// (테이블에 class ="stu"로 지정함)

// 2) tbody 삭제
// ★select에서 학급을 선택했을 때
// 기존 내역 삭제하기 위해 tbody 내용 지우기
// thead는 동일하니까
//const tbody = document.querySelector('stu > tbody'); 방법도 가능
                const tbody = ajaxList.querySelector('tbody');
                ajaxList.removeChild(tbody);

// 3) 추가할 태그 생성
                let str = '';

// 4) 새로 들어갈 내용
str += '<tbody>';
for (const stu of result) {
    str += '<tr>';
    str += `<td>${stu.productName}</td>`;
//
    str += `<td>`;
//         // (★stuNum 넘겨줘야 반이 바뀌어도 점수 상세정보 볼 수 있음)
   //     str += `<span onclick="showDetail(${stu.productNo});">
//               				  ${stu.productName}</span>`;
//         str += `</td>`;
    str += `<td>${stu.productPrice}</td>`;
    str += `<td>${stu.productDesc}</td>`;
//     str += `<td><input type="button" value="삭제"
//                        onclick="deleteStu(${stu.productNo}, this);"></td>`;
//     str += '</tr>';
//     str +=  '<td><a th:href="@{|/product/detail/${product.productNo}|}">
//         <img th:src="@{${product.productImageDTOList.get(0).getImgPath()}}" className="image"/>
//     </a></td>'
//
// }
// str += '</tbody>';

    ajaxList.insertAdjacentHTML('beforeend', str);
    // return location.href = "list/AjaxList"
}
            },
                error: function() {
                alert('실패');
            }
        });
    }
</script>

</body>
</html>